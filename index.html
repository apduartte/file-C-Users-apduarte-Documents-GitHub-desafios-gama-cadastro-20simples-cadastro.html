<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <title>Formulário | Gama Academy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- CSS (mesma pasta do index.html) -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/form.css">
  </head>
<body>

  <header class="cabecalho">
    <h1>Formação Tech - Gama Academy - Formulário</h1>
  </header>
  <main>
    <form id="cadastro-pessoal" action="enviar.php" method="POST">
      <fieldset>
        <legend>Cadastro Pessoal</legend>

        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" class="nome" required>

        <fieldset>
          <legend>Documentos</legend>
          <label for="cpf">CPF:</label>
		  <input type="text" id="cpf" name="cpf" maxlength="14" inputmode="numeric" required>         

          <label for="rg">RG:</label>
          <input type="text" id="rg" name="rg">
        </fieldset>

        <fieldset>
          <legend>Sexo</legend>
          <label><input type="radio" name="sexo" value="M"> Masculino</label>
          <label><input type="radio" name="sexo" value="F"> Feminino</label>
        </fieldset>

        <fieldset>
          <legend>Endereço</legend>

          <label for="logradouro">Logradouro:</label>
          <input type="text" id="logradouro" name="logradouro" class="endereco" required>

          <label for="numero">Número:</label>
          <input type="number" id="numero" name="numero" required>

          <label for="bairro">Bairro:</label>
          <input type="text" id="bairro" name="bairro" class="bairro">

          <label for="cidade">Cidade:</label>
          <input type="text" id="cidade" name="cidade" class="cidade">

          <label for="estado">Estado:</label>
          <select id="estado" name="estado" required>
            <option value="">-- Selecione --</option>
            <option value="SP">São Paulo</option>
            <option value="RJ">Rio de Janeiro</option>
            <option value="MG">Minas Gerais</option>
            <option value="RS">Rio Grande do Sul</option>
          </select>
		  <label for="cep">CEP:</label>
          <input type="text" id="cep" name="cep" maxlength="9" inputmode="numeric" required>
        </fieldset>

        <fieldset>
		<label for="telFixo">Telefone Fixo:</label>
        <input type="tel" id="telFixo" name="telFixo" maxlength="14" inputmode="numeric" required>

        <label for="telCelular">Telefone Celular:</label> 
        <input type="tel" id="telCelular" name="telCelular" maxlength="15" inputmode="numeric" required>
        
        </fieldset>

        <button type="submit">Enviar Formulário</button>
      </fieldset>
    </form>
  </main>

<!-- ... seu formulário e conteúdo ... -->

<div id="feedback" aria-live="polite"></div>
<script>
  const cpfInput = document.getElementById('cpf');

  cpfInput.addEventListener('input', function () {
    // Remove tudo que não for número
    let value = cpfInput.value.replace(/\D/g, '');

    // Limita a 11 dígitos
    value = value.substring(0, 11);

    // Aplica a máscara: 111.111.111-11
    if (value.length > 9) {
      value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4");
    } else if (value.length > 6) {
      value = value.replace(/(\d{3})(\d{3})(\d{1,3})/, "$1.$2.$3");
    } else if (value.length > 3) {
      value = value.replace(/(\d{3})(\d{1,3})/, "$1.$2");
    }

    cpfInput.value = value;
  });
</script> 

<script>
  const cepInput = document.getElementById('cep');

  cepInput.addEventListener('input', function () {
    let valor = cepInput.value.replace(/\D/g, '');

    // Limita a 8 dígitos
    valor = valor.substring(0, 8);

    // Aplica a máscara: 99999-999
    if (valor.length > 5) {
      valor = valor.replace(/(\d{5})(\d{1,3})/, '$1-$2');
    }

    cepInput.value = valor;
  });
</script>

<script>
  function aplicarMascaraTelefone(input, tipo) {
    input.addEventListener('input', function () {
      let valor = input.value.replace(/\D/g, '');

      if (tipo === 'fixo') {
        valor = valor.substring(0, 10);
        if (valor.length >= 10) {
          valor = valor.replace(/(\d{2})(\d{4})(\d{4})/, '($1)$2-$3');
        } else if (valor.length >= 6) {
          valor = valor.replace(/(\d{2})(\d{4})(\d{0,4})/, '($1)$2-$3');
        } else if (valor.length >= 2) {
          valor = valor.replace(/(\d{2})(\d{0,4})/, '($1)$2');
        }
      } else {
        valor = valor.substring(0, 11);
        if (valor.length >= 11) {
          valor = valor.replace(/(\d{2})(\d{5})(\d{4})/, '($1)$2-$3');
        } else if (valor.length >= 7) {
          valor = valor.replace(/(\d{2})(\d{5})(\d{0,4})/, '($1)$2-$3');
        } else if (valor.length >= 2) {
          valor = valor.replace(/(\d{2})(\d{0,5})/, '($1)$2');
        }
      }

      input.value = valor;
    });
  }

  aplicarMascaraTelefone(document.getElementById('telFixo'), 'fixo');
  aplicarMascaraTelefone(document.getElementById('telCelular'), 'celular');
</script>

<script>
  const nomePrompt = window.prompt('Qual é o seu nome?');
  if (nomePrompt && nomePrompt.trim() !== "") {
    window.alert('É uma alegria te conhecer, ' + nomePrompt);
  }

  const form = document.getElementById('cadastro-pessoal');
  const feedback = document.getElementById('feedback');

  form.addEventListener('submit', async function (e) {
    e.preventDefault();

    if (!form.reportValidity()) return;

    feedback.textContent = 'Enviando...';

    try {
      const formData = new FormData(form);

      const resp = await fetch('enviar.php', {
        method: 'POST',
        body: formData
      });

      const data = await resp.json().catch(() => ({ ok: false, message: 'Erro na resposta do servidor.' }));

      if (!resp.ok || !data.ok) {
        throw new Error(data.message || 'Falha ao salvar cadastro.');
      }

      feedback.textContent = data.message || 'Cadastro salvo com sucesso!';
      form.reset();

    } catch (err) {
      feedback.textContent = 'Erro: ' + err.message;
    }
  });
</script>
</body>
</html>
